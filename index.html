<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Grayscale Converter</title>
</head>
<body>
    <h1>Upload an Image to Convert to Grayscale</h1>
    <input type="file" id="imageInput" accept="image/png, image/jpeg" />
    <button id="uploadButton">Upload and Convert</button>
    <div id="result"></div>

    <script>
        document.getElementById('uploadButton').addEventListener('click', async () => {
            const input = document.getElementById('imageInput');
            if (input.files.length === 0) {
                alert('Please select an image.');
                return;
            }

            const file = input.files[0];
            const reader = new FileReader();

            reader.onloadend = async () => {
                const base64Image = reader.result; // This will contain the base64 string

                try {
                    const response = await fetch('<YOUR_API_GATEWAY_URL>', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            body: base64Image.split(',')[1], // Get the base64 string without the data URL prefix
                            isBase64Encoded: true,
                        }),
                    });

                    const data = await response.json();
                    if (response.ok) {
                        const imgElement = document.createElement('img');
                        imgElement.src = `data:image/png;base64,${data.body}`;
                        document.getElementById('result').innerHTML = ''; // Clear previous results
                        document.getElementById('result').appendChild(imgElement);
                    } else {
                        console.error(data.error);
                        alert('Error: ' + data.error);
                    }
                } catch (error) {
                    console.error('Fetch error:', error);
                    alert('An error occurred while processing your request.');
                }
            };

            reader.readAsDataURL(file); // Read the image as base64
        });
    </script>
</body>
</html>
